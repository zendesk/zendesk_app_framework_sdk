{"version":3,"file":"zaf_sdk.js","mappings":"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","sources":["webpack://ZAFClient/webpack/universalModuleDefinition","webpack://ZAFClient/./lib/utils/environment.ts","webpack://ZAFClient/./lib/utils/idleState.ts","webpack://ZAFClient/./lib/utils/listeners.ts","webpack://ZAFClient/./lib/utils.js","webpack://ZAFClient/./lib/tracker.js","webpack://ZAFClient/./lib/client.js","webpack://ZAFClient/./lib/index.js","webpack://ZAFClient/./node_modules/native-promise-only/lib/npo.src.js","webpack://ZAFClient/webpack/bootstrap","webpack://ZAFClient/webpack/runtime/compat get default export","webpack://ZAFClient/webpack/runtime/define property getters","webpack://ZAFClient/webpack/runtime/global","webpack://ZAFClient/webpack/runtime/hasOwnProperty shorthand","webpack://ZAFClient/webpack/startup"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"ZAFClient\"] = factory();\n\telse\n\t\troot[\"ZAFClient\"] = factory();\n})(self, function() {\nreturn ","const NODE_ENV = process.env['NODE_ENV'];\n\nexport const isProduction = NODE_ENV === 'production';\n\nexport const isDevelopment = NODE_ENV === 'development';\n\nexport const isTest = NODE_ENV === 'test';\n","import Observers, { ListenerFunction } from './listeners';\n\n/*\n  IdleState let you know if the application is active or idle. The application is considered idle if not user\n  interactions have been detected for a specific amount of time (timeout). To use IdleState, you first create an\n  IdleState instance, then you can either get the current state from the instance or add an observer to be called each\n  time the state changes.\n\n  When creating an instance, you can provide a timeout, by default timeout of 3 minutes is used. When done with the\n  IdleState instance, you must call the delete method to release it.\n\n  If several consumers create an idleState with the same timeout, only one instance is created. The instance is shared\n  between the consumers.\n\n  Syntax:\n    new IdleState();\n    new IdleState(timeout);\n\n    timeout: timeout in milliseconds, default is 3 minutes.\n\n  Properties:\n    IdleState.state:\n      current state as string, either 'active' or 'idle', read only.\n\n  Methods:\n    IdleState.addObserver(observer):\n      Add an observer to be called when the idle state changes. The observer receives the new state as parameter. You\n      can several observers.\n      Returns a function to be called to remove the observer.\n\n    IdleState.delete():\n      Release the IdleState instance. As the same instance can be shared with multiple consumers, it's important to call\n      delete() when done with it. But first, you should remove any observer you have added, else they will still be\n      called until all consumers have released the instance.\n\n  Usage:\n    import IdleState from 'utils/IdleState';\n\n    // Create an instance with a timeout of 2 minutes\n    const idleState = new IdleState(2 * 60 * 1000);\n\n    // Add an observer\n    const removeObserver = idleState.addObserver(state => {\n      if (state === 'active') {\n        // ... application is now active\n      } else if (state === 'idle') {\n        // ... application is now idle\n      }\n    });\n\n    // Read the current state\n    const currentState = idleState.state;\n\n    // When done, release the instance, but first remove the observer\n    removeObserver();\n    idleState.delete();\n*/\n\nimport { isTest } from './environment';\nexport const STATE_ACTIVE = 'active';\nexport const STATE_IDLE = 'idle';\n\nconst USER_EVENTS = ['mousemove', 'keydown', 'wheel', 'mousedown', 'touchstart', 'touchmove'];\n// list of user events to ignore when window hasn't focus as string, i.e. 'mousemove touchmove'\nconst IGNORED_USER_EVENTS = 'mousemove';\n\nconst stateProperty = Symbol('state');\n\nconst setState = (idleState: IdleState, state: 'active' | 'idle') => {\n  if (idleState[stateProperty] !== state) {\n    idleState[stateProperty] = state;\n    idleState.observers && idleState.observers.call(state);\n  }\n};\nclass IdleState {\n  refcount?: number;\n  timeout?: number;\n  [stateProperty]: 'active' | 'idle';\n  hasActiveEvent?: boolean;\n  timer?: number | null;\n  hasFocus?: boolean;\n  userEventListenerAdded?: boolean;\n  observers?: Observers;\n  setState?: (state: 'active' | 'idle') => void;\n\n  constructor(timeout) {\n    this.timeout = timeout;\n    this[stateProperty] = STATE_ACTIVE;\n    this.hasActiveEvent = true;\n    this.timer = null;\n    this.hasFocus = true;\n    this.userEventListenerAdded = false;\n    this.observers = new Observers();\n\n    this.refcount = 1;\n\n    // Bind callbacks\n    this.handleVisibilityChange = this.handleVisibilityChange.bind(this);\n    this.handleFocusChange = this.handleFocusChange.bind(this);\n    this.handleUserEvent = this.handleUserEvent.bind(this);\n    this.handleTimer = this.handleTimer.bind(this);\n\n    // Install listeners and timer\n    document.addEventListener('visibilitychange', this.handleVisibilityChange, true);\n\n    // Because Safari dispatches focus events before visibilitychange, we need to register focus/blurr listener here\n    // and not inside handleVisibilityChange with the other event listeners\n    window.addEventListener('focus', this.handleFocusChange, true);\n    window.addEventListener('blur', this.handleFocusChange, true);\n\n    this.handleVisibilityChange();\n    this.resetTimer();\n\n    // Add access to setState for testing\n    if (isTest) {\n      this.setState = (state) => {\n        setState(this, state);\n      };\n    }\n  }\n\n  delete(): void {\n    if (this.refcount !== undefined && --this.refcount === 0) {\n      document.removeEventListener('visibilitychange', this.handleVisibilityChange, true);\n      window.removeEventListener('focus', this.handleFocusChange, true);\n      window.removeEventListener('blur', this.handleFocusChange, true);\n\n      if (this.userEventListenerAdded) {\n        USER_EVENTS.forEach((type) =>\n          document.removeEventListener(type, this.handleUserEvent, true)\n        );\n      }\n\n      this.clearTimer();\n      delete this.observers;\n    }\n  }\n\n  get state(): 'active' | 'idle' {\n    return this[stateProperty];\n  }\n\n  clearTimer(): void {\n    if (this.timer) {\n      clearTimeout(this.timer);\n      this.timer = undefined;\n    }\n  }\n\n  resetTimer(): void {\n    this.clearTimer();\n    this.timer = window.setTimeout(this.handleTimer, this.timeout);\n  }\n\n  handleTimer(): void {\n    this.resetTimer();\n\n    if (this.hasActiveEvent) {\n      // we had user events during last timeout cycle,\n      // do not set state to idle yet\n      this.hasActiveEvent = false;\n    } else {\n      // we did not have user event during last timeout cycle,\n      // set state to idle now\n      setState(this, STATE_IDLE);\n    }\n  }\n\n  markActive(): void {\n    this.hasActiveEvent = true;\n    setState(this, STATE_ACTIVE);\n  }\n\n  handleUserEvent(event: Event): void {\n    if (!this.hasFocus && IGNORED_USER_EVENTS.includes(event.type)) return;\n\n    this.markActive();\n  }\n\n  handleFocusChange(event: Event): void {\n    // we only care about focus/blur event related to the window itself\n    if (event.target !== window) return;\n\n    this.hasFocus = event.type === 'focus';\n    if (this.hasFocus) {\n      this.markActive();\n    }\n  }\n\n  handleVisibilityChange(): void {\n    if (document.hidden) {\n      if (this.userEventListenerAdded) {\n        USER_EVENTS.forEach((type) =>\n          document.removeEventListener(type, this.handleUserEvent, true)\n        );\n        this.userEventListenerAdded = false;\n      }\n    } else if (!this.userEventListenerAdded) {\n      USER_EVENTS.forEach((type) => document.addEventListener(type, this.handleUserEvent, true));\n      this.userEventListenerAdded = true;\n    }\n  }\n\n  addObserver(observer: ListenerFunction): (() => void) | undefined {\n    return this.observers && this.observers.add(observer);\n  }\n}\n\nexport default IdleState;\n","export type ListenerFunction = (...args: unknown[]) => void;\n\ninterface Listener {\n  fn: ListenerFunction;\n  count: number;\n}\n\nclass Listeners {\n  private listeners: Listener[];\n\n  constructor() {\n    this.listeners = [];\n  }\n\n  add(listener: ListenerFunction): () => void {\n    const find = (listener: ListenerFunction) =>\n      this.listeners.findIndex((item) => item.fn === listener);\n\n    const index = find(listener);\n    if (index === -1) {\n      this.listeners.push({ fn: listener, count: 1 });\n    } else {\n      const listener = this.listeners[index];\n      listener && listener.count++;\n    }\n\n    return () => {\n      const index = find(listener);\n\n      if (index !== -1) {\n        const listener = this.listeners[index];\n        listener && listener.count--;\n        if (listener && listener.count === 0) {\n          this.listeners.splice(index, 1);\n        }\n      }\n    };\n  }\n\n  call(...args: unknown[]): void {\n    this.listeners.forEach((listener) => listener.fn(...args));\n  }\n}\n\nexport default Listeners;\n","import NativePromise from 'native-promise-only'\nconst Promise = window.Promise || NativePromise\n\nexport function isObject (obj) {\n  return (obj !== null && typeof obj === 'object')\n}\n\nfunction decode (s) {\n  return decodeURIComponent((s || '').replace(/\\+/g, ' '))\n}\n\nexport function queryParameters (queryString) {\n  queryString = queryString || ''\n\n  const result = {}\n  let keyValuePairs, keyAndValue, key, value\n\n  if (queryString.search(/\\?|#/) === 0) {\n    queryString = queryString.slice(1)\n  }\n\n  if (queryString.length === 0) { return result }\n\n  keyValuePairs = queryString.split('&')\n\n  for (let i = 0; i < keyValuePairs.length; i++) {\n    keyAndValue = keyValuePairs[i].split('=')\n    key = decode(keyAndValue[0])\n    value = decode(keyAndValue[1]) || ''\n    result[key] = value\n  }\n\n  return result\n}\n\nfunction isPromise (obj) {\n  if (obj instanceof Promise) return true\n  return !!obj && obj.then && typeof obj.then === 'function'\n}\n\nfunction shouldReject (val) {\n  return val === false ||\n    val instanceof Error ||\n    typeof val === 'string'\n}\n\nexport function isString (key) {\n  return typeof key === 'string'\n}\n\n// When receives a list of things to wrap as Promises.\n// it will then wait for:\n//  a) all to settle\n//  b) first to reject\n//  c) first to settle with a falsy value\n// c) is sub-optimal, since it has a specific narrow use-case\n// for save hooks\nexport function when (items) {\n  items = items || []\n  let resolveAll, rejectAll\n  const allResolvedPromise = new Promise((resolve, reject) => {\n    resolveAll = resolve\n    rejectAll = reject\n  })\n\n  let remaining = 0\n  const settledWith = []\n  const itemsCopy = Array.isArray(items) ? items.slice() : [items]\n\n  function resolveWith (data, index) {\n    settledWith[index] = data\n\n    if (--remaining <= 0) {\n      resolveAll(settledWith)\n    }\n  }\n\n  remaining = itemsCopy.length\n\n  if (remaining <= 0) {\n    resolveAll()\n    return allResolvedPromise\n  }\n\n  itemsCopy.forEach((item, index) => {\n    let promise\n    if (isPromise(item)) {\n      promise = item\n    } else if (typeof item === 'function') {\n      let res\n      try {\n        res = item()\n        if (isPromise(res)) {\n          promise = res\n        } else if (shouldReject(res)) {\n          promise = Promise.reject(res)\n        } else {\n          promise = Promise.resolve(res)\n        }\n      } catch (err) {\n        promise = Promise.reject(err)\n      }\n    } else {\n      promise = new Promise((resolve, reject) => {\n        shouldReject(item)\n          ? reject(item)\n          : resolve(item)\n      })\n    }\n    promise.then((data) => {\n      resolveWith(data, index)\n    }).catch(rejectAll.bind(rejectAll))\n  })\n\n  return allResolvedPromise\n}\n","export default class Tracker {\n  constructor (client) {\n    this.startTime = Date.now()\n    this.client = client\n    this.MIN_HOVER_TIME = 200 // milliseconds\n  }\n\n  handleMouseEnter () {\n    this.startTime = Date.now()\n  }\n\n  handleMouseLeave () {\n    const overFor = Date.now() - this.startTime\n    if (overFor >= this.MIN_HOVER_TIME) {\n      this.client.invoke('track', { type: 'hover', value: overFor })\n    }\n  }\n\n  handleClick () {\n    this.client.invoke('track', { type: 'click' })\n  }\n\n  setup () {\n    const $html = document.querySelector('html')\n    $html.addEventListener('click', this.handleClick.bind(this))\n    $html.addEventListener('mouseleave', this.handleMouseLeave.bind(this))\n    $html.addEventListener('mouseenter', this.handleMouseEnter.bind(this))\n  }\n}\n","/* global URL */\nimport pkgJson from '../package.json'\nimport { when, isObject, isString } from './utils'\nimport IdleState from './utils/idleState'\nimport Tracker from './tracker'\nimport NativePromise from 'native-promise-only'\n\nconst Promise = window.Promise || NativePromise\n\nexport const IFRAME_SESSION_TIMEOUT = 5 * 60 * 1000 // Set timeout for iframe sessions to 5 minutes.\nexport const PROMISE_TIMEOUT = 10000\n// 10 seconds, see ZD#4058685\nexport const PROMISE_TIMEOUT_LONG = 5 * 60 * 1000\n// Set a high timeout threshold to allow us to better gauge the time taken for successful requests\nconst NO_TIMEOUT_ACTIONS = ['instances.create']\nconst ZAF_EVENT = /^zaf\\./\nconst pendingPromises = {}\nconst ids = {}\n\n// // export Promise!\nwindow.Promise = Promise\n\n// @internal\n// #timeoutReject(rejectionFn, name, client, params)\n//\n// Reject a request if required, given the rejection function, name (get, set or invoke)\n// and arguments to that request. Falls back to 10000 second timeout with few exceptions.\n//\nfunction timeoutReject (client, reject, name, paramsArray) {\n  const actions = collateActions(name, paramsArray)\n  switch (name) {\n    case 'invoke': {\n      const matches = paramsArray.filter((action) => {\n        return NO_TIMEOUT_ACTIONS.indexOf(action) !== -1\n      })\n      const allWhitelisted = matches.length === paramsArray.length\n      if (allWhitelisted) {\n        return NaN // timer IDs are numbers; embrace the JavaScript 😬\n      } else {\n        const notAllWhitelisted = matches.length !== 0\n        if (notAllWhitelisted) {\n          throw new Error('Illegal bulk call - `instances.create` must be called separately.')\n        }\n        return defaultTimer(client, actions, reject)\n      }\n    }\n    default: {\n      return defaultTimer(client, actions, reject)\n    }\n  }\n}\n\nfunction defaultTimer (client, actions, callback) {\n  return setTimeout(() => {\n    trackSDKRequestTimeout(client, actions, PROMISE_TIMEOUT_LONG)\n    callback(new Error('Invocation request timeout'))\n  }, PROMISE_TIMEOUT_LONG)\n}\n\nexport function collateActions (name, params) { return params.map(action => `${name}-${action}`) }\n\nexport function stripActionArgs (action) {\n  // Capture:\n  // 1. single or multiple comma-delimited arguments following an initial colon, and\n  // 2. non-whitelisted, unescaped words following a period (i.e. file extensions in the case of assetURL calls)\n  const ACTION_ARGS = /:\\w+(,?\\w+)*((\\.(show|hide|enable|disable))|(\\\\?\\.\\w*))?/g\n  // Return :arg.field_modifier, where field modifier is (optionally) one of 'show', 'hide', 'enable' or 'disable'\n  return action.replace(ACTION_ARGS, ':arg$3')\n}\n\nexport function timeMsToSecondsRange (value, upperLimit = PROMISE_TIMEOUT_LONG) {\n  if (value >= upperLimit) return `${upperLimit / 1000}-`\n  const lowerRangeBound = value - (value % 10000)\n  return `${lowerRangeBound / 1000}-${(lowerRangeBound + 10000) / 1000}`\n}\n\nexport function trackSDKRequestTimeout (client, actions, requestResponseTime) {\n  const actionsTags = actions.map(action => `action:${stripActionArgs(action)}`)\n  const responseTimeTag = `request_response_time:${timeMsToSecondsRange(requestResponseTime)}`\n  client.postMessage('__track__', {\n    event_name: 'sdk_request_timeout',\n    event_type: 'increment',\n    data: 1,\n    tags: actionsTags.concat(responseTimeTag)\n  })\n}\n\nfunction nextIdFor (name) {\n  if (isNaN(ids[name])) {\n    ids[name] = 0\n  }\n  return ++ids[name]\n}\n\n// @internal\n// #### rawPostMessage(client, msg, forceReady)\n//\n// Post a message to the hosting frame.\n// If the client is not ready and forceReady is not specified, it will wait for client registration.\n//\nfunction rawPostMessage (client, msg, forceReady) {\n  if (client.ready || forceReady) {\n    client._source.postMessage(msg, client._origin)\n  } else {\n    client.on('app.registered', rawPostMessage.bind(null, client, msg))\n  }\n}\n\n// @internal\n// #### wrappedPostMessage(name, params)\n//\n// Wraps post message with a request/response mechanism using Promises.\n// Must be invoked in the context of a Client.\n//\n// ##### Arguments\n//\n//   * `name` the name of the request to make (get/set/invoke)\n//   * `params` parameters of the request (an array for get, and an object for set/invoke)\n//\nfunction wrappedPostMessage (name, params) {\n  const id = nextIdFor('promise')\n  let timeoutId, promiseStartTime\n  const paramsArray = Array.isArray(params) ? params : Object.keys(params)\n  const actions = collateActions(name, paramsArray)\n  const client = this\n\n  const promise = new Promise((resolve, reject) => {\n    promiseStartTime = window.performance.now()\n\n    // Time out the promise to ensure it will be garbage collected if nobody responds\n    timeoutId = timeoutReject(client, reject, name, paramsArray)\n    pendingPromises[id] = { resolve, reject }\n\n    const msg = JSON.stringify({\n      id: id,\n      request: name,\n      params: params,\n      appGuid: client._appGuid,\n      instanceGuid: client._instanceGuid\n    })\n    rawPostMessage(client, msg)\n  })\n\n  const trackTimeoutWithResolutionTime = () => {\n    const promiseResolutionTime = window.performance.now() - promiseStartTime\n    if (promiseResolutionTime > PROMISE_TIMEOUT) {\n      trackSDKRequestTimeout(client, actions, promiseResolutionTime)\n    }\n  }\n\n  // ensure promise is cleaned up when resolved/rejected, track request performance for resolved promises\n  return promise.then(\n    removePromise.bind(null, { id, timeoutId, trackTimeoutWithResolutionTime }),\n    removePromise.bind(null, { id, timeoutId })\n  )\n}\n\nfunction createError (error) {\n  if (error.path) { error.message = '\"' + error.path + '\" ' + error.message }\n  const err = new Error(error.message)\n  err.name = error.name\n  err.stack = error.stack\n  return err\n}\n\nfunction removePromise (options, args) {\n  clearTimeout(options.timeoutId)\n  delete pendingPromises[options.id]\n  options.trackTimeoutWithResolutionTime && options.trackTimeoutWithResolutionTime()\n  if (args instanceof Error) throw args\n  return args\n}\n\nfunction isValidEvent (client, event) {\n  return client && client._origin === event.origin && client._source === event.source\n}\n\nfunction triggerEvent (client, eventName, data) {\n  if (!client._messageHandlers[eventName]) { return false }\n  client._messageHandlers[eventName].forEach((handler) => {\n    handler(data)\n  })\n}\n\nfunction finalizePendingPromise (pendingPromise, data) {\n  if (data.error) {\n    const error = data.error.name ? createError(data.error) : data.error\n    pendingPromise.reject(error)\n  } else {\n    pendingPromise.resolve(data.result)\n  }\n}\n\nfunction postReplyWith (client, key, msg) {\n  if (client._repliesPending[key]) { return }\n  msg.key = 'iframe.reply:' + key\n  client._repliesPending[key] = true\n  return when(client._messageHandlers[key]).then(\n    rawPostMessage.bind(null, client, msg)\n  ).catch((reason) => {\n    // if the handler throws an error we want to send back its message, but\n    // Error objects don't pass through the postMessage boundary.\n    const rejectMessage = reason instanceof Error ? reason.message : reason\n    msg.error = {\n      msg: rejectMessage\n    }\n    rawPostMessage(client, msg)\n  }).then(() => {\n    delete client._repliesPending[key]\n  })\n}\n\nfunction getMessageRecipient (client, recipientGuid) {\n  let messageRecipient = client\n\n  if (recipientGuid && recipientGuid !== client._instanceGuid) {\n    messageRecipient = client._instanceClients[recipientGuid]\n\n    if (!messageRecipient) {\n      throw Error('[ZAF SDK] Could not find client for instance ' + recipientGuid)\n    }\n  }\n\n  return messageRecipient\n}\n\nfunction messageHandler (client, event) {\n  if (!isValidEvent(client, event)) { return }\n\n  let data = event.data\n\n  if (!data) { return }\n\n  if (typeof data === 'string') {\n    try {\n      data = JSON.parse(event.data)\n    } catch (e) {\n      return e\n    }\n  }\n\n  const clientRecipient = getMessageRecipient(client, data.instanceGuid)\n  let pendingPromise\n\n  if (data.id && (pendingPromise = pendingPromises[data.id])) {\n    finalizePendingPromise(pendingPromise, data)\n  } else if (ZAF_EVENT.test(data.key)) {\n    const key = data.key.replace(ZAF_EVENT, '')\n    const msg = { appGuid: client._appGuid }\n\n    if (data.needsReply) {\n      return postReplyWith(clientRecipient, key, msg)\n    } else {\n      triggerEvent(clientRecipient, key, data.message)\n    }\n  }\n}\n\n// When doing singular operations and we retrieve an error this function will throw that error\nfunction processResponse (path, result) {\n  const isSingularOperation = typeof path === 'string'\n\n  if (!isSingularOperation) {\n    return result\n  }\n\n  // CRUFT: When framework starts always appending errors we can remove the extra results.errors check\n  const err = result.errors && result.errors[path]\n  if (err) {\n    throw createError(err)\n  }\n\n  return result\n}\n\nfunction isOriginValid (origin) {\n  if (origin) {\n    const WHITELISTED_ORIGINS = [\n      /^https?:\\/\\/127.0.0.1(:\\d+)?$/,\n      /^https?:\\/\\/localhost(:\\d+)?$/,\n      /^https:\\/\\/.+\\.zendesk\\.com$/,\n      /^https:\\/\\/.+\\.zd-staging\\.com$/,\n      /^https:\\/\\/.+\\.zd-dev\\.com$/,\n      /^https:\\/\\/.+\\.zd-master\\.com$/,\n      /^https:\\/\\/.+\\.zendesk-staging\\.com$/,\n      // Zendesk Chat domains:\n      /^https?:\\/\\/.+\\.zopim\\.com(:\\d+)?$/,\n      /^https:\\/\\/dashboard\\.zopim\\.org$/,\n      // Zendesk Sell domains:\n      /^https:\\/\\/.+\\.futuresimple\\.com$/,\n      /^https:\\/\\/.+\\.cloudhatchery\\.com$/,\n      /^https:\\/\\/.+\\.idealwith\\.com$/,\n      // Tesco domains:\n      /^https:\\/\\/.+\\.ourtesco\\.com$/\n    ]\n\n    for (let i = 0; i < WHITELISTED_ORIGINS.length; i++) {\n      if (WHITELISTED_ORIGINS[i].test(origin)) {\n        return true\n      }\n    }\n  }\n\n  return false\n}\n\nfunction clearDocument () {\n  document.body = document.createElement('body')\n\n  const iframeHead = document.head\n  iframeHead && iframeHead.remove()\n}\n\nfunction appendErrorToBody (errorMsg) {\n  var errorElement = document.createElement('h3')\n  var errorTextNode = document.createTextNode(errorMsg)\n\n  errorElement.appendChild(errorTextNode)\n  document.body.appendChild(errorElement)\n}\n\nexport default class Client {\n  constructor (options) {\n    this._parent = options.parent\n    this._origin = options.origin || (this._parent && this._parent._origin)\n    this._source = options.source || (this._parent && this._parent._source) || window.parent\n    this._appGuid = options.appGuid || (this._parent && this._parent._appGuid)\n    this._instanceGuid = options.instanceGuid || this._appGuid\n    this._messageHandlers = {}\n    this._repliesPending = {}\n    this._instanceClients = {}\n    this._metadata = null\n    this._context = options.context || null\n    this._iframe_session_timeout = options.iframe_session_timeout || IFRAME_SESSION_TIMEOUT\n    this._idleState = null\n    this.ready = false\n\n    if (!isOriginValid(this._origin)) {\n      const originHostname = new URL(this._origin).hostname\n      this.postMessage('__track__', {\n        event_name: 'invalid_sdk_origin',\n        event_type: 'increment',\n        data: 1,\n        tags: ['origin:' + originHostname]\n      })\n\n      clearDocument()\n      appendErrorToBody(`Invalid domain ${this._origin}`)\n    }\n\n    this.on('app.registered', (data) => {\n      this.ready = true\n      this._metadata = data.metadata\n      this._context = data.context\n      this._iframe_session_timeout = data.iframe_session_timeout\n      this._idleState = new IdleState(data.iframe_session_timeout)\n      // Add an observer.  This will be called when the idleState changes\n      this._idleState.addObserver(state => {\n        if (state === 'active') {\n          // ... application is now active, timeout clock is reset to zero\n          // Send a postMessage indicating liveness + possibly a payload too\n          this.postMessage('session.live')\n        } else if (state === 'idle') {\n          // ... application is now idle, timeout clock is ticking\n          // Send a postMessage indicating sessionTimeout + possibly a payload too\n          this.postMessage('session.idle')\n        }\n      })\n    }, this)\n\n    this.on('context.updated', (context) => {\n      this._context = context\n    }, this)\n\n    if (this._parent) {\n      this.ready = this._parent.ready\n      return this // shortcut handshake\n    }\n\n    const tracker = new Tracker(this)\n    tracker.setup()\n    window.addEventListener('message', messageHandler.bind(null, this))\n    this.postMessage('iframe.handshake', { version: pkgJson.version })\n  }\n\n  /**\n   * ### Client Object\n   *\n   * #### client.postMessage(name, [data])\n   *\n   * Allows you to send message events to the Zendesk app.\n   *\n   * ##### Arguments\n   *\n   *   * `name` the name of the message event. This determines the name of the iframe\n   *     event your app will receive. For example, if you set this to 'hello', your app will receive\n   *     the event 'iframe.hello'\n   *   * `data` (optional) a JSON object with any data that you want to pass along with the\n   *     event\n   *\n   * ```javascript\n   * const client = ZAFClient.init();\n   * client.postMessage('hello', { awesome: true });\n   * ``\n   */\n  postMessage (name, data) {\n    const msg = JSON.stringify({ key: name, message: data, appGuid: this._appGuid, instanceGuid: this._instanceGuid })\n    rawPostMessage(this, msg, name === 'iframe.handshake')\n  }\n\n  /**\n   * #### client.on(name, handler, [context])\n   *\n   * Allows you to add handlers to a framework event. You can add as many handler as you wish.\n   * They will be executed in the order they were added.\n   *\n   * ##### Arguments\n   *\n   *   * `name` the name of the framework event you want to listen to. This can be\n   *     [framework](./events.html#framework-events), [request](./events.html#request-events), or\n   *     [custom](./events.html#custom-events) events. Your iframe can listen to any events your app\n   *     receives, apart from DOM events. You don't need to register these events in the app first\n   *   * `handler` a function to be called when this event fires. You can expect to receive the same\n   *     event object your app would receive, parsed as JSON\n   *   * `context` (optional) the value of `this` within your handler\n   *\n   * ```javascript\n   * const client = ZAFClient.init();\n   * client.on('app.registered', (e) => {\n   *   // go nuts\n   * });\n   * ```\n   *\n   * Note: As soon as communication with the Zendesk app is established, the SDK triggers an\n   * `app.registered` event. You can add as many handlers to `app.registered` as you like. They're\n   * called immediately after the `init` callback\n   */\n  on (name, handler, context) {\n    if (typeof handler === 'function') {\n      handler = context\n        ? handler.bind(context)\n        : handler\n\n      this._messageHandlers[name] = this._messageHandlers[name] || []\n      this._messageHandlers[name].push(handler)\n\n      if (name !== 'app.registered') {\n        // Subscriber count is needed as the framework will only bind events on the first attached handler\n        this.postMessage('iframe.on:' + name, { subscriberCount: this._messageHandlers[name].length })\n      }\n    }\n  }\n\n  /**\n   * #### client.off(name, handler)\n   *\n   * Allows you to remove a handler for a framework event.\n   *\n   * ##### Arguments\n   *\n   *   * `name` the name of the event\n   *   * `handler` the function you attached earlier with `on`\n   *\n   * ```javascript\n   * const client = ZAFClient.init();\n   *\n   * client.on('app.registered', function appRegistered(e) {\n   *   // do stuff then remove the handler\n   *   client.off('app.registered', appRegistered);\n   * });\n   * ``\n   */\n  off (name, handler) {\n    if (!this._messageHandlers[name]) { return false }\n    const index = this._messageHandlers[name].indexOf(handler)\n    if (this.has(name, handler)) {\n      this._messageHandlers[name].splice(index, 1)\n    }\n\n    // Subscriber count is needed as the framework will only unbind events on the last detached handler (count of 0)\n    this.postMessage('iframe.off:' + name, { subscriberCount: this._messageHandlers[name].length })\n    return handler\n  }\n\n  /**\n   * #### client.has(name, handler)\n   *\n   * Returns whether or not an event has the specified handler attached to it.\n   *\n   * ##### Arguments\n   *\n   *   * `name` the name of the event\n   *   * `handler` the handler you want to test\n   *\n   * ```javascript\n   * const client = ZAFClient.init();\n   *\n   * client.on('app.registered', function appRegistered(e) {\n   *   // do stuff\n   * });\n   *\n   * client.has('app.registered', appRegistered); // true\n   * client.has('app.activated', appRegistered); // false\n   * ``\n   */\n  has (name, handler) {\n    if (!this._messageHandlers[name]) { return false }\n    return this._messageHandlers[name].indexOf(handler) !== -1\n  }\n\n  /**\n   * #### client.trigger(name, [data])\n   *\n   * Triggers the specified event on the client.\n   *\n   * ##### Arguments\n   *\n   *   * `name` the name of the event you want to trigger\n   *   * `data` (optional) data you want to pass to the handler\n   *\n   * ```javascript\n   * const client = ZAFClient.init();\n   *\n   * client.on('activation', () => {\n   *   console.log('activating!')\n   * });\n   *\n   * client.trigger('activation') // activating!\n   * ``\n   */\n  trigger (name, data) {\n    this.postMessage('iframe.trigger:' + name, data)\n  }\n\n  /**\n   * #### client.request(options)\n   *\n   * Dispatch [requests](./requests) via the Zendesk app.\n   *\n   * ##### Arguments\n   *\n   *   * `options` the url of the request or an options object containing a url key/value\n   *\n   * ##### Returns\n   *\n   * A [Promises/A+](https://promisesaplus.com) conformant `promise` object.\n   *\n   * ```javascript\n   * const client = ZAFClient.init();\n   *\n   * client.request('/api/v2/tickets.json').then(\n   *   (tickets) => {\n   *     console.log(tickets);\n   *   },\n   *   (response) => {\n   *     console.error(response.responseText);\n   *   }\n   * );\n   * ``\n   */\n  request (options) {\n    if (this._parent) { return this._parent.request(options) }\n    const requestKey = 'request:' + nextIdFor('request')\n\n    return new Promise((resolve, reject) => {\n      if (typeof options === 'string') {\n        options = { url: options }\n      }\n\n      this.on(requestKey + '.done', (evt) => {\n        resolve.apply(this, evt.responseArgs)\n      })\n\n      this.on(requestKey + '.fail', (evt) => {\n        reject.apply(this, evt.responseArgs)\n      })\n\n      this.postMessage(requestKey, options)\n    })\n  }\n\n  instance (instanceGuid) {\n    if (!instanceGuid || typeof instanceGuid !== 'string') {\n      throw new Error('The instance method expects an `instanceGuid` string.')\n    }\n    if (instanceGuid === this._instanceGuid) { return this }\n    if (this._parent) { return this._parent.instance(instanceGuid) }\n    let instanceClient = this._instanceClients[instanceGuid]\n    if (!instanceClient) {\n      instanceClient = new Client({\n        parent: this,\n        instanceGuid: instanceGuid\n      })\n      this._instanceClients[instanceGuid] = instanceClient\n    }\n    return instanceClient\n  }\n\n  metadata () {\n    if (this._parent) { return this._parent.metadata() }\n    return new Promise((resolve) => {\n      if (this._metadata) {\n        resolve(this._metadata)\n      } else {\n        this.on('app.registered', () => {\n          resolve(this._metadata)\n        })\n      }\n    })\n  }\n\n  context () {\n    if (this._context) {\n      return Promise.resolve(this._context)\n    } else {\n      if (this._instanceGuid && this._instanceGuid !== this._appGuid) {\n        const key = 'instances.' + this._instanceGuid\n        return this.get(key).then((data) => {\n          this._context = data[key]\n          return this._context\n        })\n      } else {\n        return new Promise((resolve) => {\n          this.on('app.registered', (data) => {\n            resolve(data.context)\n          })\n        })\n      }\n    }\n  }\n\n  // Accepts string or array of strings.\n  get (path) {\n    const paths = Array.isArray(path) ? path : [path]\n\n    if (arguments.length > 1 || paths.some((path) => { return !isString(path) })) {\n      throw new Error('The get method accepts a string or array of strings.')\n    }\n\n    return wrappedPostMessage.call(this, 'get', paths).then(processResponse.bind(null, path))\n  }\n\n  set (key, val) {\n    let obj = key\n\n    if (typeof key === 'string') {\n      if (arguments.length === 1) {\n        throw new Error('The setter requires a value')\n      }\n      obj = {}\n      obj[key] = val\n    }\n\n    if (!isObject(obj) || Array.isArray(obj)) {\n      throw new Error('The set method accepts a key and value pair, or an object of key and value pairs.')\n    }\n\n    return wrappedPostMessage.call(this, 'set', obj).then(processResponse.bind(null, key))\n  }\n\n  invoke (keyOrObject) {\n    let obj = {}\n\n    if (typeof keyOrObject === 'string') {\n      obj[keyOrObject] = Array.prototype.slice.call(arguments, 1)\n    } else if (typeof keyOrObject === 'object') {\n      // Validate object\n      Object.keys(keyOrObject).forEach((key) => {\n        const methodArgs = keyOrObject[key]\n\n        if (!Array.isArray(methodArgs) || methodArgs.some((arg) => { return !isString(arg) })) {\n          throw new Error('Invoke supports string arguments or an object with array of strings.')\n        }\n      })\n\n      obj = keyOrObject\n    } else {\n      throw new Error('Invoke supports string arguments or an object with array of strings.')\n    }\n\n    return wrappedPostMessage.call(this, 'invoke', obj).then(processResponse.bind(null, keyOrObject))\n  }\n}\n","import Client from './client'\nimport { queryParameters } from './utils'\n\n/**\n * ### ZAFClient API\n *\n * When you include the ZAF SDK on your website, you get access to the `ZAFClient` object.\n *\n * #### ZAFClient.init([callback(context)])\n *\n * Returns a [`client`](#client-object) object.\n *\n * ##### Arguments\n *\n *   * `callback(context)` (optional) a function called as soon as communication with\n *     the Zendesk app is established. The callback receives a context object with\n *     data related to the Zendesk app, including `currentAccount`, `currentUser`, and `location`\n *\n * Example:\n *\n * ```javascript\n * const client = ZAFClient.init((context) => {\n *   const currentUser = context.currentUser;\n *   console.log('Hi ' + currentUser.name);\n * });\n * ```\n */\n\nconst ZAFClient = {\n  init: function (callback, loc) {\n    loc = loc || window.location\n    const queryParams = queryParameters(loc.search)\n    const hashParams = queryParameters(loc.hash)\n    const origin = queryParams.origin || hashParams.origin\n    const appGuid = queryParams.app_guid || hashParams.app_guid\n    if (!origin || !appGuid) { return false }\n\n    const client = new Client({ origin, appGuid })\n\n    if (typeof callback === 'function') {\n      client.on('app.registered', callback.bind(client))\n    }\n\n    return client\n  }\n}\n\nexport default ZAFClient\n","/*! Native Promise Only\n    v0.8.1 (c) Kyle Simpson\n    MIT License: http://getify.mit-license.org\n*/\n\n(function UMD(name,context,definition){\n\t// special form of UMD for polyfilling across evironments\n\tcontext[name] = context[name] || definition();\n\tif (typeof module != \"undefined\" && module.exports) { module.exports = context[name]; }\n\telse if (typeof define == \"function\" && define.amd) { define(function $AMD$(){ return context[name]; }); }\n})(\"Promise\",typeof global != \"undefined\" ? global : this,function DEF(){\n\t/*jshint validthis:true */\n\t\"use strict\";\n\n\tvar builtInProp, cycle, scheduling_queue,\n\t\tToString = Object.prototype.toString,\n\t\ttimer = (typeof setImmediate != \"undefined\") ?\n\t\t\tfunction timer(fn) { return setImmediate(fn); } :\n\t\t\tsetTimeout\n\t;\n\n\t// dammit, IE8.\n\ttry {\n\t\tObject.defineProperty({},\"x\",{});\n\t\tbuiltInProp = function builtInProp(obj,name,val,config) {\n\t\t\treturn Object.defineProperty(obj,name,{\n\t\t\t\tvalue: val,\n\t\t\t\twritable: true,\n\t\t\t\tconfigurable: config !== false\n\t\t\t});\n\t\t};\n\t}\n\tcatch (err) {\n\t\tbuiltInProp = function builtInProp(obj,name,val) {\n\t\t\tobj[name] = val;\n\t\t\treturn obj;\n\t\t};\n\t}\n\n\t// Note: using a queue instead of array for efficiency\n\tscheduling_queue = (function Queue() {\n\t\tvar first, last, item;\n\n\t\tfunction Item(fn,self) {\n\t\t\tthis.fn = fn;\n\t\t\tthis.self = self;\n\t\t\tthis.next = void 0;\n\t\t}\n\n\t\treturn {\n\t\t\tadd: function add(fn,self) {\n\t\t\t\titem = new Item(fn,self);\n\t\t\t\tif (last) {\n\t\t\t\t\tlast.next = item;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tfirst = item;\n\t\t\t\t}\n\t\t\t\tlast = item;\n\t\t\t\titem = void 0;\n\t\t\t},\n\t\t\tdrain: function drain() {\n\t\t\t\tvar f = first;\n\t\t\t\tfirst = last = cycle = void 0;\n\n\t\t\t\twhile (f) {\n\t\t\t\t\tf.fn.call(f.self);\n\t\t\t\t\tf = f.next;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t})();\n\n\tfunction schedule(fn,self) {\n\t\tscheduling_queue.add(fn,self);\n\t\tif (!cycle) {\n\t\t\tcycle = timer(scheduling_queue.drain);\n\t\t}\n\t}\n\n\t// promise duck typing\n\tfunction isThenable(o) {\n\t\tvar _then, o_type = typeof o;\n\n\t\tif (o != null &&\n\t\t\t(\n\t\t\t\to_type == \"object\" || o_type == \"function\"\n\t\t\t)\n\t\t) {\n\t\t\t_then = o.then;\n\t\t}\n\t\treturn typeof _then == \"function\" ? _then : false;\n\t}\n\n\tfunction notify() {\n\t\tfor (var i=0; i<this.chain.length; i++) {\n\t\t\tnotifyIsolated(\n\t\t\t\tthis,\n\t\t\t\t(this.state === 1) ? this.chain[i].success : this.chain[i].failure,\n\t\t\t\tthis.chain[i]\n\t\t\t);\n\t\t}\n\t\tthis.chain.length = 0;\n\t}\n\n\t// NOTE: This is a separate function to isolate\n\t// the `try..catch` so that other code can be\n\t// optimized better\n\tfunction notifyIsolated(self,cb,chain) {\n\t\tvar ret, _then;\n\t\ttry {\n\t\t\tif (cb === false) {\n\t\t\t\tchain.reject(self.msg);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (cb === true) {\n\t\t\t\t\tret = self.msg;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tret = cb.call(void 0,self.msg);\n\t\t\t\t}\n\n\t\t\t\tif (ret === chain.promise) {\n\t\t\t\t\tchain.reject(TypeError(\"Promise-chain cycle\"));\n\t\t\t\t}\n\t\t\t\telse if (_then = isThenable(ret)) {\n\t\t\t\t\t_then.call(ret,chain.resolve,chain.reject);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tchain.resolve(ret);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcatch (err) {\n\t\t\tchain.reject(err);\n\t\t}\n\t}\n\n\tfunction resolve(msg) {\n\t\tvar _then, self = this;\n\n\t\t// already triggered?\n\t\tif (self.triggered) { return; }\n\n\t\tself.triggered = true;\n\n\t\t// unwrap\n\t\tif (self.def) {\n\t\t\tself = self.def;\n\t\t}\n\n\t\ttry {\n\t\t\tif (_then = isThenable(msg)) {\n\t\t\t\tschedule(function(){\n\t\t\t\t\tvar def_wrapper = new MakeDefWrapper(self);\n\t\t\t\t\ttry {\n\t\t\t\t\t\t_then.call(msg,\n\t\t\t\t\t\t\tfunction $resolve$(){ resolve.apply(def_wrapper,arguments); },\n\t\t\t\t\t\t\tfunction $reject$(){ reject.apply(def_wrapper,arguments); }\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tcatch (err) {\n\t\t\t\t\t\treject.call(def_wrapper,err);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t\telse {\n\t\t\t\tself.msg = msg;\n\t\t\t\tself.state = 1;\n\t\t\t\tif (self.chain.length > 0) {\n\t\t\t\t\tschedule(notify,self);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcatch (err) {\n\t\t\treject.call(new MakeDefWrapper(self),err);\n\t\t}\n\t}\n\n\tfunction reject(msg) {\n\t\tvar self = this;\n\n\t\t// already triggered?\n\t\tif (self.triggered) { return; }\n\n\t\tself.triggered = true;\n\n\t\t// unwrap\n\t\tif (self.def) {\n\t\t\tself = self.def;\n\t\t}\n\n\t\tself.msg = msg;\n\t\tself.state = 2;\n\t\tif (self.chain.length > 0) {\n\t\t\tschedule(notify,self);\n\t\t}\n\t}\n\n\tfunction iteratePromises(Constructor,arr,resolver,rejecter) {\n\t\tfor (var idx=0; idx<arr.length; idx++) {\n\t\t\t(function IIFE(idx){\n\t\t\t\tConstructor.resolve(arr[idx])\n\t\t\t\t.then(\n\t\t\t\t\tfunction $resolver$(msg){\n\t\t\t\t\t\tresolver(idx,msg);\n\t\t\t\t\t},\n\t\t\t\t\trejecter\n\t\t\t\t);\n\t\t\t})(idx);\n\t\t}\n\t}\n\n\tfunction MakeDefWrapper(self) {\n\t\tthis.def = self;\n\t\tthis.triggered = false;\n\t}\n\n\tfunction MakeDef(self) {\n\t\tthis.promise = self;\n\t\tthis.state = 0;\n\t\tthis.triggered = false;\n\t\tthis.chain = [];\n\t\tthis.msg = void 0;\n\t}\n\n\tfunction Promise(executor) {\n\t\tif (typeof executor != \"function\") {\n\t\t\tthrow TypeError(\"Not a function\");\n\t\t}\n\n\t\tif (this.__NPO__ !== 0) {\n\t\t\tthrow TypeError(\"Not a promise\");\n\t\t}\n\n\t\t// instance shadowing the inherited \"brand\"\n\t\t// to signal an already \"initialized\" promise\n\t\tthis.__NPO__ = 1;\n\n\t\tvar def = new MakeDef(this);\n\n\t\tthis[\"then\"] = function then(success,failure) {\n\t\t\tvar o = {\n\t\t\t\tsuccess: typeof success == \"function\" ? success : true,\n\t\t\t\tfailure: typeof failure == \"function\" ? failure : false\n\t\t\t};\n\t\t\t// Note: `then(..)` itself can be borrowed to be used against\n\t\t\t// a different promise constructor for making the chained promise,\n\t\t\t// by substituting a different `this` binding.\n\t\t\to.promise = new this.constructor(function extractChain(resolve,reject) {\n\t\t\t\tif (typeof resolve != \"function\" || typeof reject != \"function\") {\n\t\t\t\t\tthrow TypeError(\"Not a function\");\n\t\t\t\t}\n\n\t\t\t\to.resolve = resolve;\n\t\t\t\to.reject = reject;\n\t\t\t});\n\t\t\tdef.chain.push(o);\n\n\t\t\tif (def.state !== 0) {\n\t\t\t\tschedule(notify,def);\n\t\t\t}\n\n\t\t\treturn o.promise;\n\t\t};\n\t\tthis[\"catch\"] = function $catch$(failure) {\n\t\t\treturn this.then(void 0,failure);\n\t\t};\n\n\t\ttry {\n\t\t\texecutor.call(\n\t\t\t\tvoid 0,\n\t\t\t\tfunction publicResolve(msg){\n\t\t\t\t\tresolve.call(def,msg);\n\t\t\t\t},\n\t\t\t\tfunction publicReject(msg) {\n\t\t\t\t\treject.call(def,msg);\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\tcatch (err) {\n\t\t\treject.call(def,err);\n\t\t}\n\t}\n\n\tvar PromisePrototype = builtInProp({},\"constructor\",Promise,\n\t\t/*configurable=*/false\n\t);\n\n\t// Note: Android 4 cannot use `Object.defineProperty(..)` here\n\tPromise.prototype = PromisePrototype;\n\n\t// built-in \"brand\" to signal an \"uninitialized\" promise\n\tbuiltInProp(PromisePrototype,\"__NPO__\",0,\n\t\t/*configurable=*/false\n\t);\n\n\tbuiltInProp(Promise,\"resolve\",function Promise$resolve(msg) {\n\t\tvar Constructor = this;\n\n\t\t// spec mandated checks\n\t\t// note: best \"isPromise\" check that's practical for now\n\t\tif (msg && typeof msg == \"object\" && msg.__NPO__ === 1) {\n\t\t\treturn msg;\n\t\t}\n\n\t\treturn new Constructor(function executor(resolve,reject){\n\t\t\tif (typeof resolve != \"function\" || typeof reject != \"function\") {\n\t\t\t\tthrow TypeError(\"Not a function\");\n\t\t\t}\n\n\t\t\tresolve(msg);\n\t\t});\n\t});\n\n\tbuiltInProp(Promise,\"reject\",function Promise$reject(msg) {\n\t\treturn new this(function executor(resolve,reject){\n\t\t\tif (typeof resolve != \"function\" || typeof reject != \"function\") {\n\t\t\t\tthrow TypeError(\"Not a function\");\n\t\t\t}\n\n\t\t\treject(msg);\n\t\t});\n\t});\n\n\tbuiltInProp(Promise,\"all\",function Promise$all(arr) {\n\t\tvar Constructor = this;\n\n\t\t// spec mandated checks\n\t\tif (ToString.call(arr) != \"[object Array]\") {\n\t\t\treturn Constructor.reject(TypeError(\"Not an array\"));\n\t\t}\n\t\tif (arr.length === 0) {\n\t\t\treturn Constructor.resolve([]);\n\t\t}\n\n\t\treturn new Constructor(function executor(resolve,reject){\n\t\t\tif (typeof resolve != \"function\" || typeof reject != \"function\") {\n\t\t\t\tthrow TypeError(\"Not a function\");\n\t\t\t}\n\n\t\t\tvar len = arr.length, msgs = Array(len), count = 0;\n\n\t\t\titeratePromises(Constructor,arr,function resolver(idx,msg) {\n\t\t\t\tmsgs[idx] = msg;\n\t\t\t\tif (++count === len) {\n\t\t\t\t\tresolve(msgs);\n\t\t\t\t}\n\t\t\t},reject);\n\t\t});\n\t});\n\n\tbuiltInProp(Promise,\"race\",function Promise$race(arr) {\n\t\tvar Constructor = this;\n\n\t\t// spec mandated checks\n\t\tif (ToString.call(arr) != \"[object Array]\") {\n\t\t\treturn Constructor.reject(TypeError(\"Not an array\"));\n\t\t}\n\n\t\treturn new Constructor(function executor(resolve,reject){\n\t\t\tif (typeof resolve != \"function\" || typeof reject != \"function\") {\n\t\t\t\tthrow TypeError(\"Not a function\");\n\t\t\t}\n\n\t\t\titeratePromises(Constructor,arr,function resolver(idx,msg){\n\t\t\t\tresolve(msg);\n\t\t\t},reject);\n\t\t});\n\t});\n\n\treturn Promise;\n});\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\n__webpack_require__(459);\nvar __webpack_exports__ = __webpack_require__(255);\n"],"names":["root","factory","exports","module","define","amd","self","isProduction","NODE_ENV","isDevelopment","isTest","USER_EVENTS","stateProperty","Symbol","setState","idleState","state","observers","call","constructor","timeout","this","hasActiveEvent","timer","hasFocus","userEventListenerAdded","refcount","handleVisibilityChange","bind","handleFocusChange","handleUserEvent","handleTimer","document","addEventListener","window","resetTimer","delete","undefined","removeEventListener","forEach","type","clearTimer","clearTimeout","setTimeout","markActive","event","includes","target","hidden","addObserver","observer","add","listeners","listener","find","findIndex","item","fn","index","push","count","splice","args","Promise","NativePromise","decode","s","decodeURIComponent","replace","queryParameters","queryString","keyValuePairs","keyAndValue","key","value","result","search","slice","length","split","i","isPromise","obj","then","shouldReject","val","Error","isString","when","items","resolveAll","rejectAll","allResolvedPromise","resolve","reject","remaining","settledWith","itemsCopy","Array","isArray","promise","res","err","data","resolveWith","catch","Tracker","client","startTime","Date","now","MIN_HOVER_TIME","handleMouseEnter","handleMouseLeave","overFor","invoke","handleClick","setup","$html","querySelector","PROMISE_TIMEOUT_LONG","NO_TIMEOUT_ACTIONS","ZAF_EVENT","pendingPromises","ids","defaultTimer","actions","callback","trackSDKRequestTimeout","collateActions","name","params","map","action","requestResponseTime","actionsTags","stripActionArgs","responseTimeTag","upperLimit","lowerRangeBound","timeMsToSecondsRange","postMessage","event_name","event_type","tags","concat","nextIdFor","isNaN","rawPostMessage","msg","forceReady","ready","_source","_origin","on","wrappedPostMessage","timeoutId","promiseStartTime","id","paramsArray","Object","keys","performance","matches","filter","indexOf","NaN","timeoutReject","JSON","stringify","request","appGuid","_appGuid","instanceGuid","_instanceGuid","removePromise","trackTimeoutWithResolutionTime","promiseResolutionTime","createError","error","path","message","stack","options","messageHandler","origin","source","isValidEvent","parse","e","pendingPromise","clientRecipient","recipientGuid","messageRecipient","_instanceClients","getMessageRecipient","finalizePendingPromise","test","needsReply","_repliesPending","_messageHandlers","reason","rejectMessage","postReplyWith","eventName","handler","triggerEvent","processResponse","errors","Client","_parent","parent","_metadata","_context","context","_iframe_session_timeout","iframe_session_timeout","_idleState","WHITELISTED_ORIGINS","isOriginValid","originHostname","URL","hostname","body","createElement","iframeHead","head","remove","clearDocument","errorMsg","errorElement","errorTextNode","createTextNode","appendChild","metadata","IdleState","version","pkgJson","subscriberCount","off","has","trigger","requestKey","url","evt","apply","responseArgs","instance","instanceClient","get","paths","arguments","some","set","isObject","keyOrObject","prototype","methodArgs","arg","init","loc","queryParams","location","hashParams","hash","app_guid","definition","g","builtInProp","cycle","scheduling_queue","ToString","toString","setImmediate","defineProperty","config","writable","configurable","schedule","drain","isThenable","o","_then","o_type","notify","chain","notifyIsolated","success","failure","cb","ret","TypeError","triggered","def","def_wrapper","MakeDefWrapper","iteratePromises","Constructor","arr","resolver","rejecter","idx","MakeDef","executor","__NPO__","first","last","Item","next","f","PromisePrototype","len","msgs","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","n","getter","__esModule","d","a","enumerable","globalThis","Function","prop","hasOwnProperty","__webpack_exports__"],"sourceRoot":""}